<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>=^.^=</title>
</head>
<body>

<div id="placeholder"></div>

<script src="../delaunay.js"></script>
<script src="../lib/underscore-min.js"></script>
<script>


var vvv = [{"x":2.1686367988586426,"y":192.4756897687912},{"x":9.39664912223816,"y":488.9201029539108},{"x":10.445741891860962,"y":16.28134548664093},{"x":10.939073324203491,"y":155.46950685977936},{"x":12.279634356498718,"y":216.07197892665863},{"x":14.766788601875305,"y":85.87267696857452},{"x":19.125438809394836,"y":382.26481449604034},{"x":21.894217610359192,"y":468.27233588695526},{"x":22.568485140800476,"y":337.7755968570709},{"x":29.53146719932556,"y":93.82839214801788},{"x":34.7856422662735,"y":4.161901831626892},{"x":37.75246036052704,"y":190.9123089313507},{"x":52.579785227775574,"y":323.45926105976105},{"x":77.7495459318161,"y":406.13718354701996},{"x":81.2200676202774,"y":79.8753172159195},{"x":81.62266409397125,"y":175.0619022846222},{"x":83.630983710289,"y":478.88689029216766},{"x":85.06584513187408,"y":360.33890092372894},{"x":100.58797121047974,"y":151.7551645040512},{"x":105.68172132968903,"y":364.15136539936066},{"x":110.41268575191498,"y":88.0756049156189},{"x":112.3535737991333,"y":325.81051433086395},{"x":113.42886972427368,"y":158.04437351226807},{"x":114.93117940425873,"y":193.75227415561676},{"x":115.81134617328644,"y":117.97745096683502},{"x":121.91432070732117,"y":203.11003482341766},{"x":125.25657308101654,"y":455.7767617702484},{"x":132.49254715442657,"y":359.75060045719147},{"x":133.96079623699188,"y":73.40614318847656},{"x":150.68687212467194,"y":133.80809617042542},{"x":156.82719659805298,"y":208.34633195400238},{"x":163.02967643737793,"y":36.312445521354675},{"x":174.2097294330597,"y":357.01305973529816},{"x":175.60830557346344,"y":476.5212650299072},{"x":177.81935036182404,"y":331.85264253616333},{"x":183.21723985671997,"y":499.52525758743286},{"x":194.30586731433868,"y":298.5028301477432},{"x":194.7653535604477,"y":188.5074018239975},{"x":195.5030082464218,"y":300.48048293590546},{"x":198.7181704044342,"y":412.1220107078552},{"x":208.22186374664307,"y":288.61294734477997},{"x":214.82949686050415,"y":185.53122735023499},{"x":215.8922003507614,"y":330.9999113082886},{"x":226.1120684146881,"y":232.2633330821991},{"x":228.3177706003189,"y":73.78052580356598},{"x":230.14781272411346,"y":203.25491678714752},{"x":243.125253200531,"y":394.6126871109009},{"x":249.3989087343216,"y":370.0086507797241},{"x":254.7883025407791,"y":159.77457928657532},{"x":263.2280248403549,"y":314.1272120475769},{"x":265.0256943702698,"y":7.679606080055237},{"x":271.5728451013565,"y":212.61248672008514},{"x":272.25415444374084,"y":195.11324632167816},{"x":273.1756237745285,"y":404.8625271320343},{"x":273.9409761428833,"y":361.9726332426071},{"x":276.819633603096,"y":9.29525887966156},{"x":276.8499151468277,"y":12.4601149559021},{"x":282.372310757637,"y":274.3826503753662},{"x":290.4764620065689,"y":463.7264281511307},{"x":296.701539516449,"y":170.9349285364151},{"x":301.28698658943176,"y":325.39678835868835},{"x":303.7601259946823,"y":429.9117317199707},{"x":312.9485048055649,"y":262.95418310165405},{"x":324.5404838323593,"y":433.9443337917328},{"x":330.93490266799927,"y":395.08461606502533},{"x":333.28577280044556,"y":321.8608777523041},{"x":335.2711240053177,"y":293.7619899511337},{"x":344.8021467924118,"y":75.77728343009949},{"x":350.0089074373245,"y":244.28736853599548},{"x":374.545686006546,"y":274.05285453796387},{"x":376.4565224647522,"y":459.9618458747864},{"x":377.9778674840927,"y":334.8465461730957},{"x":379.8564432859421,"y":301.1912522315979},{"x":383.55543875694275,"y":20.393126249313354},{"x":386.0721459388733,"y":260.25256955623627},{"x":388.1604552268982,"y":494.13882291316986},{"x":402.68061208724976,"y":174.95885038375854},{"x":405.63518726825714,"y":260.30428183078766},{"x":413.4564450979233,"y":375.46254670619965},{"x":416.5749866962433,"y":277.5039128065109},{"x":416.6363482475281,"y":430.08199322223663},{"x":417.59554290771484,"y":336.12811183929443},{"x":419.9287443161011,"y":346.9851874113083},{"x":424.1146490573883,"y":103.77580285072327},{"x":424.5950860977173,"y":23.285000443458557},{"x":427.8554300069809,"y":448.7593116760254},{"x":445.7137087583542,"y":399.8036620616913},{"x":448.95614087581635,"y":474.159432053566},{"x":455.109622836113,"y":369.4756933450699},{"x":456.93373465538025,"y":415.9417835474014},{"x":461.4750039577484,"y":383.35928678512573},{"x":464.17769742012024,"y":420.65040016174316},{"x":467.2374314069748,"y":428.6054700613022},{"x":467.6251245737076,"y":280.2112852334976},{"x":480.12097561359406,"y":182.19249176979065},{"x":480.9751069545746,"y":250.13958489894867},{"x":483.9958256483078,"y":474.8683580160141},{"x":488.5345447063446,"y":373.49385583400726},{"x":492.7147492170334,"y":428.32443284988403},{"x":507.9723148345947,"y":57.36841797828674}];

var width = height = 512;
var vertices = [];

// for ( var i = 0; i < 100; i ++ ) {

//   vertices.push( new Vec2( Math.random() * width, Math.random() * height ) );

// }

for ( var i = 0; i < vvv.length; i ++ ) {

  vertices.push( new Vec2( vvv[ i ].x, vvv[ i ].y ) );

}

var bbox = new BoundingRect(
  new Vec2(     0,      0 ),
  new Vec2( width, height )
);

var delaunay = new DelaunayTriangles().triangulate( vertices, bbox );

var template = _.template( [
  '<svg xmlns="http://www.w3.org/2000/svg" width="<%= rect.w * 2 %>" height="<%= rect.h * 2 %>" viewBox="-<%= rect.w * 0.5 %> -<%= rect.h * 0.5 %> <%= rect.w * 2 %> <%= rect.h * 2 %>">',
    '<rect width="<%= rect.w %>" height="<%= rect.h %>" stroke-width="0" fill="#ccc" />',
    '<circle cx="<%= c.x %>" cy="<%= c.y %>" r="<%= c.r %>" fill="none" stroke="#ccc" stroke-width="1" />',
    '<polygon points="<%= t.polygon %>" fill="none" stroke="#ccc" stroke-width="1" />',
    '<% _.each( triangles, function ( tri ) { %>',
      // '<polygon points="<%= [ tri.a.x, tri.a.y, tri.b.x, tri.b.y, tri.c.x, tri.c.y ].join() %>" fill="none" stroke="#000" stroke-width="0.5" />',
      // '<%= tri.computeCircumCircle() %>',
      // '<circle cx="<%= tri.circumCircle.center.x %>" cy="<%= tri.circumCircle.center.y %>" r="<%= tri.circumCircle.r %>" fill="none" stroke="#e9e"/>',
    '<% } ); %>',
    '<% _.each( vertices, function ( vertex ) { %>',
      '<circle cx="<%= vertex.x %>" cy="<%= vertex.y %>" r="2" fill="red"/>',
    '<% } ); %>',
  '</svg>'
].join( '' ) );

var data = {
  rect: {
    w: bbox.getWidth(),
    h: bbox.getHeight()
  },
  c: {
    x: bbox.circumCircle.center.x,
    y: bbox.circumCircle.center.y,
    r: bbox.circumCircle.r
  },
  t: {
    polygon: [
      bbox.outerTriangle.a.x,
      bbox.outerTriangle.a.y,
      bbox.outerTriangle.b.x,
      bbox.outerTriangle.b.y,
      bbox.outerTriangle.c.x,
      bbox.outerTriangle.c.y
    ].join()
  },
  triangles: delaunay.triangles,
  vertices: delaunay.vertices
}

placeholder.innerHTML = template( data );

</script>

</body>
</html>
